!function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)};function t(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function n(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function i(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}function o(e){void 0===e&&(e=void 0);var t=!!globalThis.window;return!t&&e&&console.warn(e),t}function r(e){if(void 0===e&&(e=void 0),!o())throw new Error(e||"window' is not available. Not a browser environment.");return window}var s={DEBUG:{name:"DEBUG",severity:10},INFO:{name:"INFO",severity:100},WARN:{name:"WARN",severity:1e3},ERROR:{name:"ERROR",severity:1e4},NONE:{name:"NONE",severity:1e4}},a=null;function c(){return a||(a=u())}function u(e){var t=o()&&window.__eventlakeLogLevel,n=s.WARN;if(t){var r=s[t.toUpperCase()];r&&r>0&&(n=r)}else e&&(n=e);var a={minLogLevel:n};return Object.values(s).forEach((function(e){var t=e.name,o=e.severity;a[t.toLowerCase()]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(o>=n.severity&&e.length>0){var s=e[0],a=e.splice(1),c="[EL-".concat(t,"] ").concat(s);"DEBUG"===t||"INFO"===t?console.log.apply(console,i([c],a,!1)):"WARN"===t?console.warn.apply(console,i([c],a,!1)):console.error.apply(console,i([c],a,!1))}}})),function(e,t){if(o()){var n=window;n.__eventlakeDebug||(n.__eventlakeDebug={}),n.__eventlakeDebug[e]=t}}("logger",a),a}function l(e,t,n){var i;void 0===n&&(n={});var o=e+"="+encodeURIComponent(t);if(o+="; Path="+(null!==(i=n.path)&&void 0!==i?i:"/"),n.maxAge&&(o+="; Max-Age="+Math.floor(n.maxAge)),n.domain&&(o+="; Domain="+n.domain),n.expires&&(o+="; Expires="+n.expires.toUTCString()),n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("Given option for sameSite is invalid")}return o}var p;function d(e){if(!e)return{};for(var t={},n=e.split(";"),i=0;i<n.length;i++){var o=n[i],r=o.indexOf("=");r>0&&(t[o.substr(i>0?1:0,i>0?r-1:r)]=o.substr(r+1))}return t}function h(e,t){return Array.from(e.attributes).forEach((function(e){t.setAttribute(e.nodeName,e.nodeValue)}))}function f(e,t){e.innerHTML=t;var n,i=e.getElementsByTagName("script");for(n=i.length-1;n>=0;n--){var o=i[n],r=document.createElement("script");h(o,r),o.innerHTML&&(r.innerHTML=o.innerHTML),r.setAttribute("data-eventlake-tag-id",e.id),document.getElementsByTagName("head")[0].appendChild(r),i[n].parentNode.removeChild(i[n])}}var v=function(e){return e&&decodeURIComponent(r().document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},m=function(e,t,n){void 0===n&&(n={}),r().document.cookie=l(e,t,n)},y=function(e,t){void 0===t&&(t="/"),document.cookie=e+"= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; path = "+t:"")},g=function(){return Math.random().toString(36).substring(2,12)},_=function(){return Math.random().toString(36).substring(2,7)},b={utm_source:"source",utm_medium:"medium",utm_campaign:"campaign",utm_term:"term",utm_content:"content"},k={gclid:!0,fbclid:!0,dclid:!0};var w=function(){function e(){this.queue=[]}return e.prototype.flush=function(){var e=this.queue;return this.queue=[],e},e.prototype.push=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.queue).push.apply(e,t)},e}(),P=function(){function e(e){this.key=e}return e.prototype.flush=function(){var e=this.get();return e.length&&this.set([]),e},e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.get();n.push.apply(n,e),this.set(n)},e.prototype.set=function(e){localStorage.setItem(this.key,JSON.stringify(e))},e.prototype.get=function(){var e=localStorage.getItem(this.key);return null!==e&&""!==e?JSON.parse(e):[]},e}();var S=function(e,t){c().debug("Using beacon transport",t);var n=new Blob([t],{type:"text/plain"});return navigator.sendBeacon(e,n),Promise.resolve()},E=function(e,t){return console.log("EventLake client sending payload to console only to ".concat(e),function(e){if("string"==typeof e)try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}}(t)),Promise.resolve()},x="__buildEnv__",O="__buildDate__",N="".concat("__buildVersion__","/").concat(x,"@").concat(O),A=316224e3;function C(e,t){void 0===t&&(t=void 0),""!=(t=null!=t?t:window.location.pathname)&&"/"!=t&&(y(e,t),C(e,t.slice(0,t.lastIndexOf("/"))))}var I=function(){function e(e,t){this.cookieDomain=e,this.cookieName=t}return e.prototype.save=function(e){m(this.cookieName,JSON.stringify(e),{domain:this.cookieDomain,secure:"http:"!==document.location.protocol,maxAge:A})},e.prototype.restore=function(){C(this.cookieName);var e=v(this.cookieName);if(e)try{var t=JSON.parse(decodeURIComponent(e));return"object"!=typeof t?void c().warn("Not able to retrieve value of ".concat(this.cookieName,"@").concat(this.cookieDomain,", object is expected, but found ").concat("object"!=typeof t,": ").concat(t,".")):t}catch(t){return void c().error("JSON decoding failed: "+e,t)}},e.prototype.delete=function(){y(this.cookieName)},e}(),T=function(){function e(){}return e.prototype.save=function(e){},e.prototype.restore=function(){},e.prototype.delete=function(){},e}();var j={getSourceIp:function(){},describeClient:function(){return{referer:document.referrer,url:window.location.href,page_title:document.title,doc_path:document.location.pathname,doc_host:document.location.hostname,doc_search:window.location.search,screen_resolution:screen.width+"x"+screen.height,vp_size:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)+"x"+Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),user_agent:navigator.userAgent,user_language:navigator.language,doc_encoding:document.characterSet}},getAnonymousId:function(e){var t=e.name,n=e.domain;C(t);var i=v(t);if(i)return c().debug("Existing userId",i),i;var o=g();return c().debug("New userId",o),m(t,o,{domain:n,secure:"http:"!==document.location.protocol,maxAge:A}),o}};var L={getSourceIp:function(){},describeClient:function(){return{}},getAnonymousId:function(){return""}},R=function(){return j},H=function(){return L},J=function(e,t,n,i){void 0===i&&(i=function(e,t){});var o=new window.XMLHttpRequest;return new Promise((function(r,s){o.onerror=function(e){c().error("Payload sending failed",t,e),i(-1,{}),s(new Error("JSON sending failed"))},o.onload=function(){200!==o.status?(i(o.status,{}),c().warn("Data sending failed to ".concat(e," (#").concat(o.status," - ").concat(o.statusText,")"),t),s(new Error("JSON sending failed. Response status code: ".concat(o.status,".")))):i(o.status,o.responseText),r()},o.open("POST",e),o.setRequestHeader("Content-Type","application/json"),Object.entries(n||{}).forEach((function(e){var t=e[0],n=e[1];return o.setRequestHeader(t,n)})),o.send(t),c().debug("Payload sent to server",t)}))};var q=function(){function i(){this.userProperties={},this.permanentProperties={globalProps:{},propsPerEvent:{}},this.cookieDomain="",this.apiHost="",this.idCookieName="",this.obfuscateUrl=!1,this.apiKey="",this.initialized=!1,this._3pCookies={},this.cookiePolicy="keep",this.ipPolicy="keep",this.beaconApi=!1,this.transport=J,this.customHeaders=function(){return{}},this.queue=new w,this.maxSendAttempts=4,this.retryTimeout=[500,1e12],this.flushing=!1,this.attempt=1}return i.prototype.identify=function(t,n){return this.userProperties=e(e({},this.userProperties),t),c().debug("identify() executed for user",t),this.userIdPersistence?this.userIdPersistence.save(t):c().warn("identify() method is called before Eventlake initialization"),n?Promise.resolve():this.track("user_identify",{})},i.prototype.rawTrack=function(e){return this.sendJson(e)},i.prototype.makeEvent=function(t,n,i){var r,s=i.env,a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(i,["env"]);s||(s=o()?R():H()),this.restoreId();var c=this.getCtx(s),u=e(e({},this.permanentProperties.globalProps),null!==(r=this.permanentProperties.propsPerEvent[t])&&void 0!==r?r:{}),l=e({api_key:this.apiKey,src:n,event_type:t},a),p=s.getSourceIp();return p&&(l.source_ip=p),e(e(e({},u),c),l)},i.prototype._send3p=function(e,t,n){var i="3rdparty";n&&""!==n&&(i=n);var o=this.makeEvent(i,e,{src_payload:t});return this.sendJson(o)},i.prototype.sendJson=function(e){return t(this,void 0,Promise,(function(){return n(this,(function(t){switch(t.label){case 0:return this.maxSendAttempts>1?(this.queue.push([e,0]),this.scheduleFlush(0),[3,3]):[3,1];case 1:return[4,this.doSendJson(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},i.prototype.doSendJson=function(e){var t=this,n="keep"!==this.cookiePolicy?"&cookie_policy=".concat(this.cookiePolicy):"",i="keep"!==this.ipPolicy?"&ip_policy=".concat(this.ipPolicy):"",r=o()?"/api/v1/event":"/api/v1/s2s/event",s="".concat(this.apiHost).concat(r,"?token=").concat(this.apiKey).concat(n).concat(i);this.obfuscateUrl&&(s="".concat(this.apiHost,"/api.").concat(_(),"?p_").concat(_(),"=").concat(this.apiKey).concat(n).concat(i));var a=JSON.stringify(e);return c().debug("Sending payload to ".concat(s),a),this.transport(s,a,this.customHeaders(),(function(e,n){return t.postHandle(e,n)}))},i.prototype.scheduleFlush=function(e){var t=this;if(!this.flushing){if(this.flushing=!0,void 0===e){var n=Math.random()+1,i=Math.pow(2,this.attempt++);e=Math.min(this.retryTimeout[0]*n*i,this.retryTimeout[1])}c().debug("Event queue will be flushed in ".concat(e," ms.")),setTimeout((function(){return t.flush()}),e)}},i.prototype.flush=function(){return t(this,void 0,Promise,(function(){var e,t,i=this;return n(this,(function(n){switch(n.label){case 0:if(o()&&!window.navigator.onLine&&(this.flushing=!1,this.scheduleFlush()),e=this.queue.flush(),this.flushing=!1,0===e.length)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.doSendJson(e.map((function(e){return e[0]})))];case 2:return n.sent(),this.attempt=1,c().debug("".concat(e.length," events has been flushed from queue")),[3,4];case 3:return n.sent(),(e=e.map((function(e){return[e[0],e[1]+1]})).filter((function(e){return!(e[1]>=i.maxSendAttempts)||(c().error("Max attemp (".concat(i.maxSendAttempts,") done. Queued events will be dropped after ").concat(e[1]," attempt.")),!1)}))).length>0?((t=this.queue).push.apply(t,e),this.scheduleFlush()):this.attempt=1,[3,4];case 4:return[2]}}))}))},i.prototype.postHandle=function(e,t){if("strict"===this.cookiePolicy||"comply"===this.cookiePolicy){if(200===e){var n=t;if("string"==typeof t&&(n=JSON.parse(t)),!n.delete_cookie)return}this.userIdPersistence.delete(),this.propsPersistance.delete(),y(this.idCookieName)}if(200===e){n=t;if("string"==typeof t&&t.length>0){var i=(n=JSON.parse(t)).eventlake_sdk_extras;if(i&&i.length>0)if(o())for(var r=0,s=i;r<s.length;r++){var a=s[r],u=a.type,l=a.id,p=a.value;if("tag"===u){var d=document.createElement("div");d.id=l,f(d,p),d.childElementCount>0&&document.body.appendChild(d)}}else c().error("Tags are supported only in browsers.")}}},i.prototype.getCtx=function(t){var n,i,o=new Date,r=t.describeClient()||{};return e(e({event_id:"",user:e({anonymous_id:"strict"!==this.cookiePolicy?t.getAnonymousId({name:this.idCookieName,domain:this.cookieDomain}):""},this.userProperties),ids:this._getIds(),utc_time:(n=o.toISOString(),i=n.split(".")[1],i?i.length>=7?n:n.slice(0,-1)+"0".repeat(7-i.length)+"Z":n),local_tz_offset:o.getTimezoneOffset()},r),function(e){var t={utm:{},click_id:{}};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],o=b[n];o?t.utm[o]=i:k[n]&&(t.click_id[n]=i)}return t}(function(e){if(!e)return{};for(var t=e.length>0&&"?"===e.charAt(0)?e.substring(1):e,n={},i=("?"===t[0]?t.substr(1):t).split("&"),o=0;o<i.length;o++){var r=i[o].split("=");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return n}(r.doc_search)))},i.prototype._getIds=function(){if(!o())return{};for(var e=function(e){if(void 0===e&&(e=!1),e&&p)return p;var t=d(document.cookie);return p=t,t}(!1),t={},n=0,i=Object.entries(e);n<i.length;n++){var r=i[n],s=r[0],a=r[1];this._3pCookies[s]&&(t["_"==s.charAt(0)?s.substr(1):s]=a)}return t},i.prototype.track=function(e,t){var n=t||{};c().debug("track() executed for event type",e,n);var i=this.makeEvent(e,"eventlake",t||{});return this.sendJson(i)},i.prototype.init=function(i){var r,l,p,d,h,f,v,m=this;if(o()&&!i.force_use_fetch)i.fetch&&c().warn("Custom fetch is passed. Eventlake in browser will ignore this"),this.transport=this.beaconApi?S:J;else{if(!i.fetch&&!globalThis.fetch)throw new Error("EventLake runs in Node environment. However, neither EventlakeOptions.fetch is provided, nor global fetch function is defined. \nPlease, provide custom fetch implementation. You can get it via node-fetch package");this.transport=(h=i.fetch||globalThis.fetch,function(i,o,r,s){return void 0===s&&(s=function(e,t){}),t(void 0,void 0,void 0,(function(){var t,a,u,l,p,d,f,v;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,h(i,{method:"POST",headers:e({Accept:"application/json","Content-Type":"application/json"},r||{}),body:o})];case 1:return t=n.sent(),[3,3];case 2:return a=n.sent(),c().error("Payload sending failed",o,a),s(-1,{}),[2];case 3:if(200!==t.status)return c().warn("Failed to send data to ".concat(i," (#").concat(t.status," - ").concat(t.statusText,")"),o),s(t.status,{}),[2];u={},l="",p=null!==(v=null===(f=t.headers)||void 0===f?void 0:f.get("Content-Type"))&&void 0!==v?v:"",n.label=4;case 4:return n.trys.push([4,6,,7]),[4,t.text()];case 5:return l=n.sent(),u=JSON.parse(l),[3,7];case 6:return d=n.sent(),c().error("Response parsing failed for ".concat(i,". Content-type: ").concat(p," text: ").concat(l),d),[3,7];case 7:try{s(t.status,u)}catch(e){c().error("".concat(i," response handling failed. Content-type: ").concat(p," text: ").concat(l),e)}return[2]}}))}))})}if(i.custom_headers&&"function"==typeof i.custom_headers?this.customHeaders=i.custom_headers:i.custom_headers&&(this.customHeaders=function(){return i.custom_headers}),!0===i.console_transport&&(c().warn('eventlakeClient is configured with "echo" transport. Outgoing requests will be written to console'),this.transport=E),i.ip_policy&&(this.ipPolicy=i.ip_policy),i.cookie_policy&&(this.cookiePolicy=i.cookie_policy),"strict"===i.privacy_policy&&(this.ipPolicy="strict",this.cookiePolicy="strict"),i.use_beacon_api&&navigator.sendBeacon&&(this.beaconApi=!0),"comply"===this.cookiePolicy&&this.beaconApi&&(this.cookiePolicy="strict"),i.log_level&&(f=i.log_level,(v=s[f.toLocaleUpperCase()])||(console.warn("Incorrect log level name: ".concat(f.toLocaleUpperCase(),", setting default to INFO")),v=s.INFO),a=u(v)),this.initialOptions=i,c().debug("Initializing EventLake",i,N),i.key){if(this.cookieDomain=i.cookie_domain||function(){if(o())return window.location.hostname.replace("www.","")}(),this.apiHost=function(e){for(;n="/",-1!==(t=e).indexOf(n,t.length-n.length);)e=e.substr(0,e.length-1);var t,n;return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:"//"+e}(i.api_host||"api.eventlake.io"),this.obfuscateUrl=i.obfuscate_url||!1,this.idCookieName=i.cookie_name||"__eventlake_id",this.apiKey=i.key,"strict"===this.cookiePolicy?this.propsPersistance=new T:this.propsPersistance=o()?new I(this.cookieDomain,this.idCookieName+"_props"):new T,"strict"===this.cookiePolicy?this.userIdPersistence=new T:this.userIdPersistence=o()?new I(this.cookieDomain,this.idCookieName+"_usr"):new T,this.propsPersistance){var y=this.propsPersistance.restore();y&&(this.permanentProperties=y,this.permanentProperties.globalProps=null!==(r=y.globalProps)&&void 0!==r?r:{},this.permanentProperties.propsPerEvent=null!==(l=y.propsPerEvent)&&void 0!==l?l:{}),c().debug("Properties loaded from cookies",this.permanentProperties)}var g,_;!1===i.capture_3rd_party_cookies?this._3pCookies={}:(i.capture_3rd_party_cookies||["_ga","_fbp","_ym_uid","ajs_user_id","ajs_anonymous_id"]).forEach((function(e){return m._3pCookies[e]=!0})),i.ga_interceptor&&c().warn("GA event interceptor isn't supported anymore"),i.segment_interceptor&&(g=this,(_=window).analytics||(_.analytics=[]),g.interceptAnalytics(_.analytics)),o()&&(i.disable_event_persistence||(this.queue=new P("eventlake-event-queue"),this.scheduleFlush(0)),window.addEventListener("beforeunload",(function(){return m.flush()}))),this.retryTimeout=[null!==(p=i.min_send_timeout)&&void 0!==p?p:this.retryTimeout[0],null!==(d=i.max_send_timeout)&&void 0!==d?d:this.retryTimeout[1]],i.max_send_attempts&&(this.maxSendAttempts=i.max_send_attempts),this.initialized=!0}else c().error("Failed to initialize EventLake. API key is not passed.")},i.prototype.interceptAnalytics=function(t){var n=this,i=function(t){var i;try{var o=e({},t.payload);c().debug("Segment payload intercepted",o.obj);var r=t.integrations["Segment.io"];if(r&&r.analytics){var s=r.analytics;"function"==typeof s.user&&s.user()&&"function"==typeof s.user().id&&(o.obj.userId=s.user().id())}(null===(i=null==o?void 0:o.obj)||void 0===i?void 0:i.timestamp)&&(o.obj.sentAt=o.obj.timestamp);var a=t.payload.type();"track"===a&&(a=t.payload.event()),n._send3p("ajs",o,a)}catch(e){c().warn("Event sending failed",e)}t.next(t.payload)};"function"==typeof t.addSourceMiddleware?(c().debug("analytics.js is initialized"),c().debug("Calling addSourceMiddleware of analytics"),t.addSourceMiddleware(i)):(c().debug("analytics.js initialization failed"),t.push(["addSourceMiddleware",i]))},i.prototype.restoreId=function(){if(this.userIdPersistence){var t=this.userIdPersistence.restore();t&&(this.userProperties=e(e({},t),this.userProperties))}},i.prototype.set=function(t,n){var i,o=null==n?void 0:n.eventType,r=void 0===(null==n?void 0:n.persist)||(null==n?void 0:n.persist);if(void 0!==o){var s=null!==(i=this.permanentProperties.propsPerEvent[o])&&void 0!==i?i:{};this.permanentProperties.propsPerEvent[o]=e(e({},s),t)}else this.permanentProperties.globalProps=e(e({},this.permanentProperties.globalProps),t);this.propsPersistance&&r&&this.propsPersistance.save(this.permanentProperties)},i.prototype.unset=function(e,t){r();var n=null==t?void 0:t.eventType,i=void 0===(null==t?void 0:t.persist)||(null==t?void 0:t.persist);n?this.permanentProperties.propsPerEvent[n]&&delete this.permanentProperties.propsPerEvent[n][e]:delete this.permanentProperties.globalProps[e],this.propsPersistance&&i&&this.propsPersistance.save(this.permanentProperties)},i}(),M="eventlake.min.js",D=["cookie_name","cookie_domain","key","ga_interceptor","segment_interceptor","use_beacon_api","obfuscate_url","capture_3rd_party_cookies","identify_method","log_level","privacy_policy","cookie_policy","ip_policy","custom_headers","force_use_fetch","min_send_timeout","max_send_timeout","max_send_attempts","disable_event_persistence","console_transport"],U="data-suppress-interception-warning";function z(e){return"\n      Warning! ".concat(e,"-interceptor is true with defer/async attribute in script. \n      If ").concat(e," code is inserted after EventLake script tag, first tracking call may not be intercepted.\n      Please refer to the doc for more information.")}function F(e,t){c().debug("Processing event queue",e);for(var n=0;n<e.length;n+=1){var o=i([],e[n],!0)||[],r=o[0],s=o.slice(1),a=t[r];"function"==typeof a&&a.apply(t,s)}e.length=0}if(window){var B=window,Q=function(e){var t=document.currentScript||document.querySelector("script[src*=jsFileName][data-eventlake-api-key]");if(t){var n,i={api_host:(n=t.getAttribute("src"),n.replace("/a/"+M,"").replace("/"+M,"")),key:null};D.forEach((function(e){var n="data-"+e.replace(new RegExp("_","g"),"-");if(void 0!==t.getAttribute(n)&&null!==t.getAttribute(n)){var o=t.getAttribute(n);"true"===o?o=!0:"false"===o&&(o=!1),i[e]=o}})),e.eventlakeClient=function(e){var t=new q;return t.init(e),t}(i),!i.segment_interceptor||null===t.getAttribute("defer")&&null===t.getAttribute("async")||null!==t.getAttribute(U)||c().warn(z("segment")),!i.ga_interceptor||null===t.getAttribute("defer")&&null===t.getAttribute("async")||null!==t.getAttribute(U)||c().warn(z("ga"));var o=function(){var t=e.eventlakeQ=e.eventlakeQ||[];t.push(arguments),F(t,e.eventlakeClient)};return e.eventlake=o,"true"!==t.getAttribute("data-init-only")&&"yes"!==t.getAttribute("data-init-only")&&o("track","pageview"),e.eventlakeClient}c().warn("EventLake is not properly initialized. data-eventlake-api-key parameter is missing")}(B);Q?(c().debug("EventLake is initialized in browser"),B.eventlake=function(){var e=B.eventlakeQ=B.eventlakeQ||[];e.push(arguments),F(e,Q)},B.eventlakeQ&&(c().debug("Previous queue is going to be processed first. q_size: ".concat(B.eventlakeQ.length)),F(B.eventlakeQ,Q))):c().error("EventLake has not been initialized due to unknown error")}else c().warn("EventLake called outside browser context. It will be ignored")}();
